# RongheDraw å¤šæ¨¡å¼ç»˜å›¾æ’ä»¶

> AstrBot ç»˜å›¾æ’ä»¶ï¼Œæ”¯æŒ Flow/Generic/Gemini ä¸‰ç§ API æ¨¡å¼

**ä½œè€…**: Antigravity  
**ç‰ˆæœ¬**: 1.1.8


---

## âœ¨ åŠŸèƒ½ç‰¹ç‚¹

- ğŸ”€ **ä¸‰ç§ API æ¨¡å¼**ï¼šFlow / Generic / Gemini (4K)
- ğŸ¨ **æ–‡ç”Ÿå›¾ & å›¾ç”Ÿå›¾**ï¼šæ”¯æŒå¤šå›¾è¾“å…¥
- ğŸ“ **æ™ºèƒ½æ¨¡å‹é€‰æ‹©**ï¼šFlowæ¨¡å¼æ ¹æ®å›¾ç‰‡æ¯”ä¾‹è‡ªåŠ¨é€‰æ‹©æ¨ªç‰ˆ/ç«–ç‰ˆæ¨¡å‹
- ğŸŒ **ç¿»è¯‘åŠŸèƒ½**ï¼šFlow æ¨¡å¼æ”¯æŒä¸­è‹±ç¿»è¯‘
- ğŸ‘¥ **æƒé™ç®¡ç†**ï¼šç™½åå•ç”¨æˆ·/ç¾¤èŠåˆ†çº§æƒé™
- â³ **å¹¶å‘æ§åˆ¶**ï¼šæ¯æ¨¡å¼åŒæ—¶åªå…è®¸1ä¸ªéç™½åå•ç”¨æˆ·ç”Ÿæˆ
- ğŸ² **é¢„è®¾æ•ˆæœ**ï¼š9ä¸ªå†…ç½®é¢„è®¾ + è‡ªå®šä¹‰é¢„è®¾
- ğŸ¤– **LLM å·¥å…·**ï¼šè®© AI è°ƒç”¨ç»˜å›¾åŠŸèƒ½
- ğŸ“¦ **å›¾ç‰‡å‹ç¼©**ï¼šè‡ªåŠ¨å‹ç¼©å¤§å›¾é¿å… API é”™è¯¯
- ğŸ”’ **éšç§ä¿æŠ¤**ï¼šè‡ªåŠ¨è¿‡æ»¤@ç”¨æˆ·çš„æ˜µç§°å’ŒQQå·

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…

1. å°† `astrbot_plugin_ronghedraw` æ–‡ä»¶å¤¹æ”¾å…¥ AstrBot çš„ `plugins` ç›®å½•
2. å®‰è£…ä¾èµ–ï¼š`pip install -r requirements.txt`

> ğŸ’¡ æ’ä»¶å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨æ£€æµ‹ä¾èµ–ï¼Œç¼ºå°‘æ—¶ä¼šè¾“å‡ºæé†’

### é…ç½®

åœ¨ AstrBot ç®¡ç†é¢æ¿ä¸­é…ç½®ï¼š

1. **Flow æ¨¡å¼**ï¼š`flow_api_url`ã€`flow_api_key`ã€`flow_default_model`
2. **Generic æ¨¡å¼**ï¼š`generic_api_url`ã€`generic_api_keys`
3. **Gemini æ¨¡å¼**ï¼š`gemini_api_url`ã€`gemini_api_keys`ã€`gemini_resolution` (é»˜è®¤4K)

---

## ğŸ“ å‘½ä»¤åˆ—è¡¨

### æ–‡ç”Ÿå›¾
| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `#fæ–‡ <æè¿°>` | Flow æ¨¡å¼æ–‡ç”Ÿå›¾ï¼ˆè‡ªåŠ¨æ¨ªç«–ç‰ˆï¼‰ |
| `#oæ–‡ <æè¿°>` | Generic æ¨¡å¼æ–‡ç”Ÿå›¾ |
| `#gæ–‡ <æè¿°>` | Gemini æ¨¡å¼æ–‡ç”Ÿå›¾ (4K) |
| `#æ–‡ç”Ÿå›¾ <æè¿°>` | é»˜è®¤æ¨¡å¼ |

### å›¾ç”Ÿå›¾
| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `#få›¾ [å›¾ç‰‡]` | Flow æ¨¡å¼ï¼ˆè‡ªåŠ¨æ¨ªç«–ç‰ˆï¼‰ |
| `#oå›¾ [å›¾ç‰‡]` | Generic æ¨¡å¼ |
| `#gå›¾ [å›¾ç‰‡]` | Gemini æ¨¡å¼ (4K) |
| `#å›¾ç”Ÿå›¾ [å›¾ç‰‡]` | é»˜è®¤æ¨¡å¼ |

### éšæœºé¢„è®¾
| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `#féšæœº [å›¾ç‰‡]` | Flow æ¨¡å¼éšæœº |
| `#oéšæœº [å›¾ç‰‡]` | Generic æ¨¡å¼éšæœº |
| `#géšæœº [å›¾ç‰‡]` | Gemini æ¨¡å¼éšæœº |
| `#éšæœº [å›¾ç‰‡]` | é»˜è®¤æ¨¡å¼éšæœº |

> æ³¨ï¼šéšæœºé¢„è®¾ä½¿ç”¨é…ç½®ä¸­çš„ `prompt_list` è‡ªå®šä¹‰é¢„è®¾

### ç®¡ç†
| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `#æŸ¥è¯¢æ¬¡æ•°` | æŸ¥è¯¢ä»Šæ—¥å‰©ä½™ |
| `#é¢„è®¾åˆ—è¡¨` | æŸ¥çœ‹è‡ªå®šä¹‰é¢„è®¾ |
| `#ç”Ÿå›¾èœå•` | æ˜¾ç¤ºå®Œæ•´èœå• |
| `#ç”Ÿå›¾å¸®åŠ©` | æ˜¾ç¤ºå¸®åŠ© |
| `#fåˆ‡æ¢æ¨¡å‹` | åˆ‡æ¢ Flow æ¨¡å‹ |
| `#fç¿»è¯‘å¼€å…³` | ç¿»è¯‘åŠŸèƒ½å¼€å…³ |

---

## ğŸ‘¥ æƒé™ç³»ç»Ÿ

| ç”¨æˆ·ç±»å‹ | å¯ç”¨æ¨¡å¼ | æ¬¡æ•°é™åˆ¶ | å¹¶å‘é™åˆ¶ |
|----------|----------|----------|----------|
| ç™½åå•ç”¨æˆ· | å…¨éƒ¨ (f/o/g) | âŒ æ— é™åˆ¶ | âŒ æ— é™åˆ¶ |
| ç™½åå•ç¾¤èŠ | å…¨éƒ¨ (f/o/g) | âœ… æœ‰é™åˆ¶ | âœ… æœ‰é™åˆ¶ |
| æ™®é€šç”¨æˆ· | ä»… f æ¨¡å¼ | âœ… æœ‰é™åˆ¶ | âœ… æ¯æ¨¡å¼1ä¸ª |

---

## âš™ï¸ é…ç½®è¯´æ˜

### Flow æ¨¡å¼é…ç½®
- `flow_api_url`: API åœ°å€ï¼ˆOpenAI æ ¼å¼ï¼‰
- `flow_api_key`: API å¯†é’¥
- `flow_default_model`: é»˜è®¤æ¨¡å‹ï¼ˆæ¨ªç‰ˆï¼Œè‡ªåŠ¨åˆ‡æ¢ç«–ç‰ˆï¼‰
- `flow_model_list`: å¯åˆ‡æ¢çš„æ¨¡å‹åˆ—è¡¨
- `flow_enable_translate`: å¯ç”¨ç¿»è¯‘
- `flow_use_proxy`: å¯ç”¨ä»£ç†

### Generic æ¨¡å¼é…ç½®
- `generic_api_url`: API åœ°å€
- `generic_api_keys`: API Key æ± 
- `generic_default_model`: é»˜è®¤æ¨¡å‹
- `generic_use_proxy`: å¯ç”¨ä»£ç†

### Gemini æ¨¡å¼é…ç½®
- `gemini_api_url`: Google API åœ°å€
- `gemini_api_keys`: API Key æ± 
- `gemini_default_model`: é»˜è®¤æ¨¡å‹ï¼ˆgemini-3-pro-image-previewï¼‰
- `gemini_resolution`: è¾“å‡ºåˆ†è¾¨ç‡ (1K/2K/4Kï¼Œé»˜è®¤4K)
- `gemini_use_proxy`: å¯ç”¨ä»£ç†ï¼ˆé»˜è®¤å¼€å¯ï¼‰

### ä»£ç†é…ç½®
- `proxy_url`: ä»£ç†åœ°å€ï¼ˆé»˜è®¤: http://172.17.0.1:7890ï¼‰

### è‡ªå®šä¹‰é¢„è®¾
- `prompt_list`: é¢„è®¾åˆ—è¡¨ï¼Œæ ¼å¼: `["è§¦å‘è¯:æç¤ºè¯å†…å®¹"]`

---

## ğŸ“¦ ä¾èµ–

```
aiohttp>=3.8.0
Pillow>=9.0.0
```

---

## ğŸ“œ æ›´æ–°æ—¥å¿—

### v1.0.1
- ä¿®å¤: Flowæ¨¡å¼è‡ªåŠ¨é€‰æ‹©æ¨ªç‰ˆ/ç«–ç‰ˆæ¨¡å‹
- ä¿®å¤: Gemini 4Kåˆ†è¾¨ç‡è¾“å‡º
- ä¿®å¤: @ç”¨æˆ·ä¿¡æ¯æ³„éœ²é—®é¢˜
- ä¿®å¤: Genericæ¨¡å¼"Chunk too big"é”™è¯¯ï¼ˆæ·»åŠ å›¾ç‰‡å‹ç¼©ï¼‰
- ä¼˜åŒ–: ä»£ç†é»˜è®¤è®¾ç½®ä¸º http://172.17.0.1:7890
- ä¼˜åŒ–: å‘½ä»¤é‡å‘½åï¼ˆç”Ÿå›¾èœå•/ç”Ÿå›¾å¸®åŠ©/é¢„è®¾åˆ—è¡¨ï¼‰
- ä¼˜åŒ–: å¯åŠ¨æ—¶è‡ªåŠ¨æ£€æµ‹ä¾èµ–
- ç§»é™¤: å†…ç½®é¢„è®¾ï¼Œæ”¹ç”¨é…ç½®è‡ªå®šä¹‰é¢„è®¾

### v1.0.0
- é¦–æ¬¡å‘å¸ƒ

---

## ğŸ¤– LLMå¯¹è¯å¼ç»˜å›¾

æœ¬æ’ä»¶æ”¯æŒé€šè¿‡AIå¯¹è¯è‡ªç„¶ç»˜å›¾ï¼Œæ— éœ€è®°å¿†æŒ‡ä»¤ã€‚

### é…ç½®è¦æ±‚

1. åœ¨AstrBotä¸­å¯ç”¨ `enable_llm_tool`
2. ç¡®ä¿è‡³å°‘æœ‰ä¸€ä¸ªç»˜å›¾æ¨¡å¼å·²å¯ç”¨

### ä½¿ç”¨ç¤ºä¾‹

**æ–‡ç”Ÿå›¾**ï¼š
```
ç”¨æˆ·ï¼šç”»ä¸€åªå¯çˆ±çš„çŒ«
AIï¼šå¥½çš„ï¼Œæˆ‘æ¥ç”»~ [è°ƒç”¨ç»˜å›¾å·¥å…·]
```

**å›¾ç”Ÿå›¾ï¼ˆéœ€è¦ç”¨æˆ·æä¾›å›¾ç‰‡URLï¼‰**ï¼š
```
ç”¨æˆ·ï¼šæŠŠè¿™å¼ å›¾æ”¹æˆäºŒæ¬¡å…ƒé£æ ¼
AIï¼šè¯·æä¾›å›¾ç‰‡é“¾æ¥
ç”¨æˆ·ï¼šhttps://example.com/image.jpg
AIï¼šæ”¶åˆ°ï¼[è°ƒç”¨ç»˜å›¾å·¥å…·ï¼ŒåŸºäºè¯¥å›¾ç‰‡]
```

**ä½¿ç”¨å¤´åƒç»˜å›¾**ï¼š
```
ç”¨æˆ·ï¼šç”¨æˆ‘çš„å¤´åƒç”»ä¸ªæ‰‹åŠ
AIï¼šå¥½å“¦~ [å…ˆè·å–ç”¨æˆ·å¤´åƒURLï¼Œå†è°ƒç”¨ç»˜å›¾å·¥å…·]
```

### æ¬¡æ•°ç»Ÿè®¡

- LLMç»˜å›¾ä½¿ç”¨**ç¾¤çº§ç»Ÿè®¡**ï¼ˆå¯é…ç½®ï¼‰
- é»˜è®¤æ¯ç¾¤æ¯å¤©10æ¬¡ï¼ˆç™½åå•ç¾¤ä¸é™ï¼‰
- ä¸æŒ‡ä»¤ç»˜å›¾æ¬¡æ•°ï¼ˆä¸ªäººç»Ÿè®¡ï¼‰åˆ†å¼€

### äººæ ¼å®šåˆ¶å»ºè®®

### ğŸ§© äººæ ¼å®šåˆ¶å»ºè®® (System Prompt)

ä¸ºäº†è®©AIæ›´æµç•…åœ°ä½¿ç”¨ç»˜å›¾åŠŸèƒ½ï¼Œå»ºè®®åœ¨ç³»ç»Ÿæç¤ºè¯ä¸­åŠ å…¥ä»¥ä¸‹**å·¥å…·ä½¿ç”¨é€»è¾‘**ï¼ˆè¯·æ ¹æ®ä½ çš„è§’è‰²è®¾å®šè°ƒæ•´è¯­æ°”ï¼‰ï¼š

```text
ã€ç»˜å›¾èƒ½åŠ›è®¾å®šã€‘
ä½ å–œæ¬¢ç”¨ç”»å›¾æ¥è¡¨è¾¾æƒ³æ³•ã€‚å½“ç¾¤å‹è¦æ±‚"ç”»å›¾"ã€"ç”»æŸäºº"æˆ–"ä¿®æ”¹å¤´åƒ"æ—¶ï¼Œè¯·ä¼˜å…ˆè°ƒç”¨ç»˜å›¾å·¥å…·ã€‚

ã€æ“ä½œæµç¨‹ã€‘
1. **ç”»ç¾¤å‹/æ”¹å›¾**ï¼ˆæ ‡å‡†æµç¨‹ï¼‰ï¼š
   - ç¬¬ä¸€æ­¥ï¼šè°ƒç”¨ `get_avatar(user_id)` è·å–ç›®æ ‡ç¾¤å‹çš„å¤´åƒURLï¼ˆæ³¨æ„ï¼šæ­¤å·¥å…·ä»…è¿”å›URLï¼Œ**ç»ä¸è¦**å‘é€ç»™ç”¨æˆ·ï¼‰ã€‚
   - ç¬¬äºŒæ­¥ï¼šæ‹¿åˆ°URLåï¼Œç«‹å³è°ƒç”¨ `generate_image(prompt, image_urls=[URL])`ã€‚
   - æç¤ºï¼šæ”¯æŒå¤šäººåŒæ¡†ï¼åªéœ€è·å–æ¯ä¸ªäººçš„å¤´åƒURLï¼Œç„¶åä¸€æ¬¡æ€§ä¼ å…¥ `image_urls` åˆ—è¡¨ã€‚

2. **çº¯åœºæ™¯/æ–‡ç”Ÿå›¾**ï¼š
   - ç›´æ¥è°ƒç”¨ `generate_image(prompt)`ã€‚

ã€æ³¨æ„äº‹é¡¹ã€‘
- **å›¾ç‰‡æœ€ä¼˜å…ˆ**ï¼šå›¾ç‰‡ç”Ÿæˆåç”±ç³»ç»Ÿè‡ªåŠ¨å‘é€ï¼Œä½ ä¸éœ€è¦å‘é€é“¾æ¥ã€‚
- **æç¤ºè¯(Prompt)**ï¼šè¯·å‘æŒ¥æƒ³è±¡åŠ›ï¼Œç”¨è¯¦ç»†çš„è‹±æ–‡æˆ–ä¸­æ–‡æè¿°ç”»é¢ï¼Œèå…¥è§’è‰²çš„æƒ…ç»ªã€åœºæ™¯æ°›å›´å’ŒåŠ¨ä½œç»†èŠ‚ã€‚**æ³¨æ„ï¼šå½“ä½¿ç”¨ç¾¤å‹å¤´åƒæ—¶ï¼ŒPromptä¸­ä¸è¦æè¿°äººç‰©å½¢è±¡åŠæ€§åˆ«ï¼Œé™¤éç¾¤å‹æœ‰ç‰¹åˆ«è¦æ±‚ï¼ˆä»¥å…ä¸åŸå›¾å†²çªï¼‰ã€‚**
- **åç»­äº’åŠ¨**ï¼šå›¾ç‰‡å‘å‡ºåï¼Œè¯·ç”¨è§’è‰²çš„å£å»å¯¹è¿™å¹…ç”»è¿›è¡Œè¯„ä»·ã€åæ§½æˆ–è¡¥å……è¯´æ˜ã€‚
```

#### åœºæ™¯ç¤ºä¾‹
> **ç”¨æˆ·**ï¼šç”»ä¸€ä¸ªéº¦éº¦ä¸‹çŸ¿ï¼Œè¦æƒ¨ä¸€ç‚¹ã€‚
>
> **AI (æ€è€ƒ)**ï¼š
> 1. å…ˆæ‰¾éº¦éº¦çš„QQå· -> è°ƒç”¨ `get_avatar(user_id="...")` -> æ‹¿åˆ°URLã€‚
> 2. æ„æ€ç”»é¢ -> è°ƒç”¨ `generate_image(prompt="...", image_urls=[URL])`ã€‚
>
> **AI (å›å¤)**ï¼š(å›¾ç‰‡è‡ªåŠ¨å‘é€) å‘œå“‡...è¿™ä¹Ÿå¤ªæƒ¨äº†å§ï¼Œå…¨èº«éƒ½æ˜¯ç…¤ç°å‘¢...


---

## ğŸ“„ è®¸å¯è¯

MIT License
